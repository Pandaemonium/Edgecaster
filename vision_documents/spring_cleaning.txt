SPRING CLEANING – ACTIONABLE PLAN (CURRENT STATUS: ABILITY BAR EXTRACTED)
Legend: [CLEANUP] structural/no-behavior change; [BEHAVIOR] gameplay change; [VISION] future/idea.
Updated after refactor of the Ability Bar into a standalone UI widget.

===============================================================================
SLICE 1: Renderer / Input Untangle [CLEANUP] — COMPLETE ENOUGH FOR NOW
Goal: ascii.py is draw-only; scenes own all input and UI logic.

Current status:
✓ ascii.py now owns NO input
✓ All input → GameInput → GameCommand → DungeonScene._handle_command
✓ Renderer only computes hitboxes and draws
Remaining impurities: dialog UI + config UI still partly in ascii.py

Next micro-steps:
- Move dialog/config selection state from ascii.py into dedicated scene models
- Renderer should receive view-models only

===============================================================================
SLICE 2: Ability Bar Overhaul [CLEANUP] — BASELINE COMPLETE
Goal: renderer-agnostic ability system driven entirely by Actions.

Current status:
✓ AbilityBarState implemented and scene-owned
✓ AbilityBarRenderer view-only; ascii.py just calls draw()
✓ systems/actions.py defines canonical actions (with show_in_bar)

NEW (IMPORTANT):
Actions ALSO define:
- icon / glyph
- color hints
- sub-button metadata (e.g. parameter +/–, gear/config buttons)
AbilityBarRenderer imports the metadata and builds all UI elements dynamically.
Scenes only handle routing; renderer does not embed UI rules.

Next micro-steps:
- Remove remaining legacy renderer ability code (icon helpers optional)
- Add a small AbilityConfigScene for advanced per-ability settings if needed

===============================================================================
SLICE 3: Targeting System Generalization [CLEANUP/BEHAVIOR] — NEXT PRIORITY
Goal: unified TargetMode for all targeted actions.

Plan:
1) Introduce a TargetState model on DungeonScene
2) While active → movement keys move cursor
3) Confirm → resolve + dispatch
4) Cancel → exit
5) Renderer draws target cursor only

When complete:
- No special-case “terminus mode” or “aim mode”
- Keyboard + mouse parity for all targeted actions

===============================================================================
SLICE 4: Custom Fractal Pipeline [CLEANUP]
Current status:
✓ Ability bar correctly triggers custom fractal editor via action metadata
Next:
- Ensure editor returns unified vertices/edges dict
- Confirm identical click alignment for all window modes

===============================================================================
SLICE 5: Inventory Cleanup [CLEANUP]
Goal: per-entity inventories with clear helpers.

Current status:
✓ Core helper APIs implemented in game.py
✓ Nested containers supported
Next:
- Additional UI polish in InventoryScene
- Consider simple item stacking

===============================================================================
SLICE 6: Data-Driven Entities [CLEANUP/BEHAVIOR]
Goal: all entities defined by YAML.

Current status:
✓ entities.yaml + factory in place
✓ Berries/containers generated from templates
Next:
- Expand component-style properties
- Move remaining hardcoded objects into content layer

===============================================================================
Deferred / Vision Targets
- [VISION] Full renderer swapability (ASCII → tiles)
- [VISION] Spell/action effects as “effect entities”
- [VISION] Procedural spawn tables
- [VISION] Behavior trees for AI

===============================================================================
Current tactical focus:
→ IMPLEMENT UNIFIED TARGETMODE (SLICE 3)
Dynamic ability sub-buttons + action metadata are now stable; targeting is the
main structural piece that benefits from unification.

