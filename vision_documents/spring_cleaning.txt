SPRING CLEANING — ACTIONABLE PLAN
(Current Status: Action-driven abilities, unified TargetMode, hierarchical entities)

Legend: [CLEANUP] structural/no-behavior change; [BEHAVIOR] gameplay change;  
        [VISION] long-term design direction.

===============================================================================
SLICE 1: Renderer / Input Untangle [CLEANUP] — COMPLETE ENOUGH FOR NOW
Goal: ascii.py is draw-only; scenes own input + UI logic.

✓ ascii.py owns no input  
✓ Input → GameInput → GameCommand → DungeonScene._handle_command  
✓ Renderer only draws, computes hitboxes  

Remaining impurities:
- A few UI overlays still styled directly in ascii.py
- Lorenz trail state now correctly lives in game/lorenz

Next micro-step:
- Fine-grain separation of visual-only UI effects vs scene logic

===============================================================================
SLICE 2: Ability Bar Overhaul [CLEANUP] — COMPLETE
Goal: Metadata-driven ability bar (icons, labels, sub-buttons).

✓ AbilityBarState scene-owned  
✓ AbilityBarRenderer view-only  
✓ actions.py defines all metadata  
✓ Bar updates automatically when host actor changes  
✓ Kochbender kit added via entity.actions (to be moved to character gen templates)

Next steps:
- Integrate class templates / origins into the entity-spawn pipeline  
- Clean ability injection at player creation

===============================================================================
SLICE 3: Unified TargetMode [CLEANUP/BEHAVIOR] — COMPLETE (FOUNDATION)
Goal: One targeting system for everything.

✓ TargetState implemented (tile / vertex / look)  
✓ Keyboard + mouse unified  
✓ Confirm/cancel fully routed through DungeonScene  
✓ Renderer only draws cursor + overlays  
✓ Actions declare targeting rules via TargetingSpec

Next steps:
- Add ranged, teleport, cone, and line targeting  
- Add graph-neighbor cycling for vertex mode  
- Add preview layers for more complex target shapes

===============================================================================
SLICE 4: Look / Inspect System [BEHAVIOR] — NEWLY COMPLETE
Goal: Roguelike-style examination with entity inheritance.

✓ `look_action` triggers look-style TargetMode  
✓ Hover shows yellow entity label  
✓ Confirm shows UrgentMessage popup with:
    - Title (name)
    - Big glyph (colored)
    - Inherited description via prototype chain  
✓ Look mode remains active after closing popup for smooth multi-inspection  
✓ Foundation for lore / ecology / procedural biology

Next steps:
- Dedicated InspectScene with scrollable stats, abilities, materials  
- Auto-inspection on targeting (aim-preview)

===============================================================================
SLICE 5: Entity Inheritance System [CLEANUP/BEHAVIOR] — NEW CORE SUBSYSTEM
Goal: Every entity derives from a parent; child overrides fields.

✓ YAML prototypes define `parent`, `glyph`, `color`, `description`, stats  
✓ Loader resolves inheritance into flattened prototypes  
✓ Runtime entities tagged with their archetype  
✓ Hierarchical lookup used for inspection and future AI

Next steps:
- Add component flags (AI, materials, interactions)  
- Add biological attributes (size, tissues, metabolism)  
- Make items & actors share more systems (unified physics/HP/etc.)

===============================================================================
SLICE 6: Inventory Cleanup [CLEANUP] — PARTIALLY COMPLETE
✓ Nested containers  
✓ InventoryScene stable  
Remaining:
- UI polish  
- Stacking and weight systems  
- Auto-sort modes

===============================================================================
SLICE 7: Data-Driven Everything [VISION]
- Move combat stats, resistances, speeds into templates  
- Add behavior components (aggressive, curious, brittle, fractal)  
- Spawners use prototype metadata  
- Entities become fully component-based

===============================================================================
DEFERRED / LONG-TERM VISION
- Optional tile/sprite renderer  
- Behavior-tree AI  
- Procedural pantheons + god-planets (Yggen long-term)  
- Lore generation using hierarchical entity metadata  
- Full action-economy redesign (interrupts, reactions, timings)

===============================================================================
Current tactical focus:
→ Extend unified TargetMode  
→ Expand entity prototype components  
→ Stabilize inheritance + inspection for future systems  
